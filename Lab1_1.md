测试程序
````cpp
A=diag(ones(1,84)*6)+diag(ones(1,83),1)+diag(ones(1,83)*8,-1);
b=ones(84,1);b(1)=7;b(84)=14;b(2:83)=15;
n=84;
%Gauss消元
[A1]=GaussLU(A,n);
L1=tril(A1,-1)+eye(n);
U1=triu(A1);
%Ly=b
[Y1]=LowerTriangle(L1,b,n);
%Ux=y
[X1]=UpperTriangle(U1,b,n);

%全主元消去法
[P2,Q2,A2,b2]=TotalPivotLU(A,b,n);
L2=tril(A2,-1)+eye(n);
U2=triu(A2);
%Ly=Pb=b2
[Y2]=LowerTriangle(L2,b2,n);
%Uz=y
[X2]=UpperTriangle(U2,Y2,n);
%x=Qz
for k=1:n-1
    q=Q2(k);
    X2([k,q],:)=X2([q,k],:);
end

%列主元消去法
[P3,A3,b3]=ColumnPivotLU(A,b,n);
L3=tril(A3,-1)+eye(n);
U3=triu(A3);
%Ly=Pb=b3
[Y3]=LowerTriangle(L3,b3,n);
%Ux=y
[X3]=UpperTriangle(U3,Y3,n);
````

结果演示

  + Gauss消元法
  
X1=[0.731673 2.609960 2.820185 2.913495 2.957554 2.978974 2.989535 2.994780 2.997393 2.998697 2.999349 2.999674 2.999837 2.999919 2.999959 2.999980 2.999990 2.999995 2.999997 2.999999 2.999999 3.000000 3.000000 3.000000 3.000000 3.000000 3.000000 3.000000 3.000000 3.000000 3.000000 3.000000 3.000000 3.000000 3.000000 3.000000 3.000000 3.000000 3.000000 3.000000 3.000000 3.000000 3.000000 3.000000 3.000000 3.000000 3.000000 3.000000 3.000000 3.000000 3.000000 3.000000 3.000000 3.000000 3.000000 3.000000 3.000000 3.000000 3.000000 3.000000 3.000000 3.000000 3.000000 3.000000 3.000000 3.000000 3.000000 3.000000 3.000000 3.000000 3.000000 3.000000 3.000000 3.000000 2.999998 3.000008 2.999969 3.000122 2.999512 3.001953 2.992188 3.031250 2.875000 3.500000]'

  + 全主元消去法
  
x2=[1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000001 0.999999 1.000002 0.999997]'

  + 列主元消去法
  
X3=[1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000001 0.999999 1.000002 0.999997]'

算法分析

易知精确解为X=ones(84,1),由结果可知，Gauss消元法不稳定，全主元消去法和列主元消去法较稳定，结果更精确。

函数源代码实现

+ Gauss消元法
````cpp
function[A]=GaussLU(A,n)
%Purpose:A=LU L为单位下三角阵 U为上三角阵
%Method:Gauss Elimination
%Input:A
%Output:A:变换后的矩阵 L,U仍存储在A中,L为A不含对角线的下半部分+I
%Complexity:O(n^3)
%适用于1至（n-1）阶顺序主子式均非奇异的情况
for k=1:n-1
    if(A(k,k)~=0)
         A(k+1:n,k)=A(k+1:n,k)/A(k,k);
         A(k+1:n,k+1:n)=A(k+1:n,k+1:n)-A(k+1:n,k)*A(k,k+1:n);
    else disp('矩阵奇异');
    end
end
````
+ 全主元消去法
````cpp
function[P,Q,A,b]=TotalPivotLU(A,b,n)
%Purpose:PAQ=LU L为单位下三角阵 U为上三角阵 
%Method:Total Pivot+Gauss Elimination
%Input:A,n
%Output:A:A变换后的矩阵,L,U仍存储在A中;P,Q:以列向量表示，记录每一步的I_kp的p下标,Q_kq的q下标;
%       b:行置换后的列向量Pb
%Complexity:O(n^3)
%比Gauss消去法稳定，但选取主元比较需要O(n^3)
P=ones(n,1);Q=ones(n,1);%注意初始化时不要使用zero，否则下标最后一个为0
for k=1:n-1
    B=zeros(n);
    B(k:n,k:n)=A(k:n,k:n);
    max_k=max(max(abs(B)));
    [p,q]=find(abs(B)==max_k,1); 
    P(k)=p;
    Q(k)=q;
    if (p~=k)
        A([k,p],:)=A([p,k],:);%交换矩阵第k,p行
        b([k,p])=b([p,k]);%交换列向量b第k,p行
    end    
    if(q~=k)    
        A(:,[k,q])=A(:,[q,k]);
    end
    if(A(k,k)~=0)
        A(k+1:n,k)=A(k+1:n,k)/A(k,k);
        A(k+1:n,k+1:n)=A(k+1:n,k+1:n)-A(k+1:n,k)*A(k,k+1:n);
    else disp('矩阵奇异');
    end
end
````

+ 列主元消去法
````cpp
function[P,A,b]=ColumnPivotLU(A,b,n)
%Purpose:PA=LU L为单位下三角阵 U为上三角阵 P为初等置换阵
%Method:Column Pivot+Gauss Elimination
%Input:A,n
%Output:A:A变换后的矩阵,L,U仍存储在A中;P:以列向量表示，记录每一步的I_kp的p下标;
%       b:行置换后的列向量Pb
%Complexity:O(n^3)
%适用于中小型稠密方程组,选取主元需要O(n^2)
P=ones(n,1);
for k=1:n-1
    B=zeros(n,1);
    B(k:n)=A(k:n,k);
    max_k=max(abs(B));
    [p,q]=find(abs(B)==max_k,1);
    P(k)=p;
    if (p~=k)
        A([k,p],:)=A([p,k],:);%交换矩阵第k,p行
        b([k,p])=b([p,k]);%交换列向量b第k,p行
    end 
    if(A(k,k)~=0)
         A(k+1:n,k)=A(k+1:n,k)/A(k,k);
         A(k+1:n,k+1:n)=A(k+1:n,k+1:n)-A(k+1:n,k)*A(k,k+1:n);
    else disp('矩阵奇异');
    end
end
````